---
title: "econ_assignment4"
author: "Jessica Jagdeo"
date: "May 28, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(tidyverse)

carbon_data <- read_csv("HW4Data.csv")

```

1. Model of marginal cost of abatement for each sector

```{r, visualizing data to find functional form}

# Exploratory Graphs

sector_a <- ggplot(carbon_data, aes(x = Abatement, y = MC_A)) + 
  geom_point()
sector_a
# Looks linear enough...?


sector_b <- ggplot(carbon_data, aes(x = Abatement, y = MC_B)) + 
  geom_point()
sector_b
# idk

sector_c <- ggplot(carbon_data, aes(x = Abatement, y = MC_C)) + 
  geom_point()
sector_c
# Exponential...?

sector_d <- ggplot(carbon_data, aes(x = Abatement, y = MC_D)) + 
  geom_point()
sector_d
#idk 

```

```{r, estimating parameters}

# Linear Regressions

# Sector A

sector_a_model <- lm(MC_A ~ Abatement, data = carbon_data)
sector_a_model

# Cost of carbon abatement = 0.5768*(Abatement) - 8.6445


# Sector B
sector_b_model <- lm(MC_B ~ Abatement, data = carbon_data)
sector_b_model

# Cost of carbon abatement = 0.1987*(Abatement) + 9.3177


# Sector C
sector_c_model <- lm(MC_C ~ Abatement, data = carbon_data)
sector_c_model

# Cost of carbon abatement = 0.78388(Abatement) - 11.6550


# Sector D
sector_d_model <- lm(MC_D ~ Abatement, data = carbon_data)
sector_d_model

# Cost of abatement = 0.2599*(Abatement) + 9.6875

```

```{r, model fit}

# Detailed model information

# Sector A

summary(sector_a_model)

# R^2 = 0.9104, p for model fit = 1.01e-08

# Basd on this model, Tons of carbon abatement significanly predicts marginal cost of abatement,  R^2 is the proportion of the variance in cost of abatement that is explained by the tons of carbon abatement. 91% of variance in cost is predictable by tons of carbon abatement and 9% of variance in cost is not predictable by tons.


# Sector B
summary(sector_b_model)

# R^2 = 0.5664, p = 0.0007672

# Secctor C
summary(sector_c_model)

# R^2 = 0.8752, p = 1.044e-07

# Sector D
summary(sector_d_model)
# R^2 = 0.5434, p = 0.001121


```

2. Demand Curve

```{r}

#Find the intersection of the marginal cost curves with current emissions from each sector:


# Sector A

# Cost of carbon abatement = 0.5768*(Abatement) - 8.6445

# Current emissions is 180 tons

0.5768*180-8.6445 # Equals $95.18

# Points: (180, 0) and (0, 95.18)

# Slope: -0.5287778

(95.18-0)/(0-180)

# Y-intercept: 95.18



# Sector B

# Cost of carbon abatement = 0.1987*(Abatement) + 9.3177

# Current emissions are 200 tons

0.1987*200+9.3177 # Equals $49.06

# Points: (200, 0) and (0, 49.06)

# Slope: -0.2453

(49.06-0)/(0-200)

# Y-intercept: 49.06



# Sector C

# Cost of carbon abatement = 0.78388(Abatement) - 11.6550

# Current emissions are 220 tons

0.78388*220-11.6550 # Equals $160.80

# Points: (220, 0) and (0, 160.80)

# Slope: -0.7309091

(160.80-0)/(0-220)

# Y-intercept: 160.80



# Sector D

# Cost of abatement = 0.2599*(Abatement) + 9.6875

# Current emissions are 300 tons

0.2599*300+9.6875 # Equals $87.66

# Points: (300, 0) and (0, 87.66)

# Slope: -0.2922

(87.66-0)/(0-300)

# Y-intercept: 87.66

```

```{r}

# Demand curves for each sector:


# Sector A

# y = -0.5287778X + 95.18



# Sector B

# y = -0.2453X + 49.06




# Sector C

# y = -0.7309091X + 160.80




# Sector D

# y =  -0.2922X + 87.66


```

```{r}

graph <- ggplot(carbon_data) +
  geom_abline(intercept = 87.66, slope = -0.2922)

graph

```

